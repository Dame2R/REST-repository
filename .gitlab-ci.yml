stages:
  - test
  - deploy-vm

api-test:
  stage: test
  script: 
    - echo 'perform api test'

update-code-on-vm:
  image: alpine:latest
  stage: deploy-vm
  tags:
    - deployment
  script:
    - chmod og= $ID_RSA
    - apk update && apk add openssh-client
    - ssh -i $ID_RSA -o StrictHostKeyChecking=no $SERVER_USER@$SERVER_IP "cd wi-inf-projekt-2-greenbpm/; git fetch; git pull;"
  environment:
    name: production
    url: http://vm11.fkc.hft-stuttgart.de
  only:
    - develop
